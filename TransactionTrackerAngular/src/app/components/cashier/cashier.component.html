<div class="card">
    <p-toast></p-toast>
    <h5>Cashier</h5>
    <form [formGroup]="cashierForm">
        <div class="grid" style="min-height:120px" >
            <div class="field mr-2">
                <h5>
                    <label>Product</label>
                </h5>
                <p-autoComplete formControlName="product" [suggestions]="productResults"
                                (completeMethod)="searchProducts($event)" field="name"
                                [forceSelection]="true"></p-autoComplete>
                <div>
                    <small class="ng-dirty ng-invalid"
                           *ngIf="product?.errors?.required && (product.dirty || product.touched)">Product is
                        required.</small>
                </div>
            </div>
            <div class="field">
                <h5>
                    <label for="quantity">Quantity </label>
                </h5>
                <input type="number" id="quantity" name="quantity" formControlName="quantity" pInputText>
                <div>
                    <small class="ng-dirty ng-invalid"
                           *ngIf="quantity?.errors?.required && (quantity.dirty || quantity.touched)">Quantity is
                        required.</small>
                    <small class="ng-dirty ng-invalid"
                           *ngIf="quantity?.errors?.min && (quantity.dirty || quantity.touched)">Quantity has to be
                        >= {{quantity?.errors?.min.min}}.</small>
                </div>
            </div>
            <button pButton (click)="addProduct()" type="button" label="Click" ></button>
        </div>
    </form>
    <p-table #dt
             [value]="transactionDetails"
             responsiveLayout="scroll"
             [rows]="10"
             [paginator]="true"
             [rowsPerPageOptions]="[10,20,30]"
             [showCurrentPageReport]="true"
             currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
             [rowHover]="true" dataKey="id">
        <ng-template pTemplate="caption">
            <div class="flex flex-column md:flex-row md:justify-content-between md:align-items-center">
                <h5 class="m-0">Transaction Details</h5>
            </div>
            <div class="flex ">
                <h5>total {{total}} Ft</h5>
            </div>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th pSortableColumn="name">Name
                    <p-sortIcon field="name"></p-sortIcon>
                </th>
                <th>Image</th>
                <th pSortableColumn="price">Price
                    <p-sortIcon field="price"></p-sortIcon>
                </th>
                <th pSortableColumn="quantity">Quantity
                    <p-sortIcon field="quantity"></p-sortIcon>
                </th>
                <th pSortableColumn="sub-total">Sub-Total
                    <p-sortIcon field="sub-total"></p-sortIcon>
                </th>
                <th></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-transactionDetail let-index="rowIndex">
            <tr>
                <td style="width:14%; min-width:10rem;">
                    <span class="p-column-title">Name</span>
                    {{transactionDetail.product.name}} {{index}}
                </td>
                <td style="width:14%; min-width:10rem;"><span class="p-column-title">Image</span>
                    <img [src]="transactionDetail.product.image" [alt]="transactionDetail.product.name" width="100"
                         class="shadow-4"/>
                </td>
                <td style="width:14%; min-width:8rem;">
                    <span class="p-column-title">Price</span>
                    {{transactionDetail.product.price | currency: 'HUF ': 'symbol':'1.0-0'}}
                </td>
                <td style="width:14%; min-width:10rem;">
                    <span class="p-column-title">Quantity</span>
                    {{transactionDetail.quantity}}
                </td>
                <td style="width:14%; min-width:10rem;">
                    <span class="p-column-title">Sub-Total</span>
                    {{transactionDetail.quantity * transactionDetail.product.price | currency: 'HUF ': 'symbol':'1.0-0' }}
                </td>
                <td>
                    <div class="flex">
                        <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-warning"
                                (click)="deleteTransactionDetail(index)"></button>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
    <p-confirmDialog></p-confirmDialog>
</div>
